"use strict";(()=>{var e={};e.id=6041,e.ids=[6041],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},91641:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var s={};a.r(s),a.d(s,{GET:()=>l});var r=a(49303),o=a(88716),i=a(60670),n=a(19692),c=a(87070);async function l(){try{let e=await (0,n.t)(),{data:{user:t}}=await e.auth.getUser();if(!t)return c.NextResponse.json({error:"Unauthorized"},{status:401});let{count:a}=await e.from("gologin_profiles").select("*",{count:"exact",head:!0}),{data:s}=await e.from("gologin_profiles").select("status, gmail_status"),r={idle:0,running:0,paused:0,error:0},o={ok:0,blocked:0,not_checked:0,other:0};s?.forEach(e=>{r[e.status]++,e.gmail_status&&"unknown"!==e.gmail_status?"ok"===e.gmail_status?o.ok++:"blocked"===e.gmail_status?o.blocked++:o.other++:o.not_checked++});let{data:i}=await e.from("automation_tasks").select("status, created_at").order("created_at",{ascending:!1}).limit(100),l={total:i?.length||0,pending:i?.filter(e=>"pending"===e.status).length||0,running:i?.filter(e=>"running"===e.status).length||0,completed:i?.filter(e=>"completed"===e.status).length||0,failed:i?.filter(e=>"failed"===e.status).length||0},u=l.completed+l.failed>0?Math.round(l.completed/(l.completed+l.failed)*100):0,d=new Date(Date.now()-864e5).toISOString(),{count:p}=await e.from("activity_logs").select("*",{count:"exact",head:!0}).gte("created_at",d),{data:g}=await e.from("activity_logs").select("success").gte("created_at",d),h={total:p||0,successful:g?.filter(e=>e.success).length||0,failed:g?.filter(e=>!e.success).length||0};return c.NextResponse.json({profiles:{total:a||0,byStatus:r},gmail:o,tasks:l,successRate:u,activity:h})}catch(e){return console.error("[v0] Error fetching dashboard stats:",e),c.NextResponse.json({error:e.message},{status:500})}}let u=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dashboard/stats/route",pathname:"/api/dashboard/stats",filename:"route",bundlePath:"app/api/dashboard/stats/route"},resolvedPagePath:"D:\\appProject\\GologinAutomation\\gologin\\app\\api\\dashboard\\stats\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:g}=u,h="/api/dashboard/stats/route";function m(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},19692:(e,t,a)=>{a.d(t,{t:()=>o});var s=a(67721),r=a(71615);async function o(){let e=await (0,r.cookies)();return(0,s.createServerClient)("https://umhdnhckxgqywxgpybgo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtaGRuaGNreGdxeXd4Z3B5YmdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDA1NzYsImV4cCI6MjA3NDk3NjU3Nn0.sodO3ZUaTWDxBBZitsrc_j3SUmVWBNlAsQoDAdzs8mI",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:a,options:s})=>e.set(t,a,s))}catch{}}}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,4526,9702,5972],()=>a(91641));module.exports=s})();
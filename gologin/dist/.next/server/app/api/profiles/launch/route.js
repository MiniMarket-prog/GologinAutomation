"use strict";(()=>{var e={};e.id=7645,e.ids=[7645],e.modules={85129:e=>{e.exports=require("gologin")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},77250:e=>{e.exports=import("puppeteer-core")},4761:(e,o,r)=>{r.a(e,async(e,t)=>{try{r.r(o),r.d(o,{originalPathname:()=>f,patchFetch:()=>c,requestAsyncStorage:()=>u,routeModule:()=>g,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p});var s=r(49303),l=r(88716),n=r(60670),i=r(17596),a=e([i]);i=(a.then?(await a)():a)[0];let g=new s.AppRouteRouteModule({definition:{kind:l.x.APP_ROUTE,page:"/api/profiles/launch/route",pathname:"/api/profiles/launch",filename:"route",bundlePath:"app/api/profiles/launch/route"},resolvedPagePath:"D:\\appProject\\GologinAutomation\\gologin\\app\\api\\profiles\\launch\\route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:u,staticGenerationAsyncStorage:p,serverHooks:d}=g,f="/api/profiles/launch/route";function c(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:p})}t()}catch(e){t(e)}})},17596:(e,o,r)=>{r.a(e,async(e,t)=>{try{r.r(o),r.d(o,{POST:()=>a});var s=r(87070),l=r(19692),n=r(53541),i=e([n]);async function a(e){try{let{profileId:o}=await e.json();if(!o)return s.NextResponse.json({error:"Profile ID is required"},{status:400});let r=await (0,l.t)(),{data:t,error:i}=await r.from("gologin_profiles").select("*").eq("id",o).single();if(i||!t)return s.NextResponse.json({error:"Profile not found"},{status:404});console.log(`[v0] Launching profile ${t.profile_name} in local mode...`);let a=process.env.GOLOGIN_API_KEY;if(!a)return s.NextResponse.json({error:"GoLogin API key not configured"},{status:500});let c=new n.r(a,"local"),{browser:g,page:u}=await c.launchProfile(t.gologin_id);if(!g)return s.NextResponse.json({error:"Failed to launch browser"},{status:500});console.log("[v0] Opening Gmail in new tab...");let p=await g.newPage();return await p.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),console.log(`[v0] ✓ Gmail opened successfully`),console.log(`[v0] ✓ Profile launched successfully`),console.log("[v0] Browser will stay open until manually closed"),s.NextResponse.json({success:!0,message:"Profile launched successfully. Browser will stay open until you close it manually.",profileName:t.profile_name})}catch(e){return console.error("[v0] Error launching profile:",e),s.NextResponse.json({error:e instanceof Error?e.message:"Failed to launch profile"},{status:500})}}n=(i.then?(await i)():i)[0],t()}catch(e){t(e)}})},53541:(e,o,r)=>{r.a(e,async(e,t)=>{try{r.d(o,{r:()=>i});var s=r(77250),l=r(83098),n=e([s]);s=(n.then?(await n)():n)[0];class i{constructor(e,o="cloud"){this.gologinInstance=null,this.gologinAPI=new l.X(e),this.apiKey=e,this.mode=o}async validateProfile(e){try{return console.log(`[v0] Validating profile ${e} with GoLogin API...`),await this.gologinAPI.getProfileStatus(e),console.log(`[v0] ✓ Profile validation successful`),{valid:!0}}catch(e){if(console.error(`[v0] ❌ Profile validation failed:`,e.message),e.message.includes("404")||e.message.includes("not found")||e.message.includes("deleted"))return{valid:!1,error:"Profile has been deleted from GoLogin",errorType:"PROFILE_DELETED"};if(e.message.includes("401")||e.message.includes("unauthorized"))return{valid:!1,error:"GoLogin API authentication failed",errorType:"AUTH_ERROR"};return{valid:!1,error:`Profile validation failed: ${e.message}`,errorType:"VALIDATION_ERROR"}}}async launchProfile(e){console.log("[v0] ========================================"),console.log(`[v0] Launching GoLogin profile: ${e}`),console.log(`[v0] Mode: ${this.mode.toUpperCase()}`),console.log("[v0] ========================================");try{let o;if("local"===this.mode){console.log("[v0] Step 1: Starting profile locally using GoLogin SDK...");try{let{GologinApi:t}=await Promise.resolve().then(r.t.bind(r,85129,23));this.gologinInstance=t({token:this.apiKey}),console.log("[v0] Launching local profile...");let{browser:s}=await this.gologinInstance.launch({profileId:e});o=s.wsEndpoint(),console.log(`[v0] ✓ Local profile launched`),console.log("[v0] Using LOCAL mode - connecting to local Orbita browser")}catch(e){if(console.error(`[v0] ❌ Failed to load GoLogin SDK for local mode`),console.error(`[v0] Error: ${e.message}`),e.message&&(e.message.includes("404")||e.message.includes("not found")||e.message.includes("deleted")))throw Error("PROFILE_DELETED: Profile has been deleted from GoLogin");throw console.error("[v0] Local mode requires running in a Node.js environment with GoLogin Desktop app installed"),Error("Local mode is not available in this environment. Please use Cloud mode or run the application locally with Node.js.")}}else console.log("[v0] Step 1: Starting profile via GoLogin API..."),await this.gologinAPI.startProfile(e),o=`wss://cloudbrowser.gologin.com/connect?token=${this.apiKey}&profile=${e}`,console.log("[v0] Using CLOUD mode - connecting to GoLogin cloud browser");console.log("[v0] Step 2: Connecting to WebSocket..."),console.log(`[v0] WebSocket URL: ${o.replace(this.apiKey,"***API_KEY***")}`);let t=await s.default.connect({browserWSEndpoint:o,defaultViewport:null,protocolTimeout:3e5});console.log(`[v0] ✓ Connected to browser`),console.log("[v0] Step 3: Getting browser page...");let l=await t.pages();console.log(`[v0] Found ${l.length} open pages`);let n=l[0]||await t.newPage();return console.log("[v0] ========================================"),console.log(`[v0] ✓✓✓ Profile ${e} launched successfully in ${this.mode.toUpperCase()} mode ✓✓✓`),console.log("[v0] ========================================"),{browser:t,page:n,success:!0}}catch(r){console.error("[v0] ========================================"),console.error(`[v0] ❌ Failed to launch profile ${e}`),console.error(`[v0] Error type: ${r.name}`),console.error(`[v0] Error message: ${r.message}`),console.error("[v0] Error stack:",r.stack),console.error("[v0] ========================================");let o=r.message?.startsWith("PROFILE_DELETED:")?"PROFILE_DELETED":"LAUNCH_ERROR";return{browser:null,page:null,success:!1,error:r.message,errorType:o}}}async closeProfile(e,o){console.log(`[v0] Closing profile: ${e}`);try{if(o&&(console.log("[v0] Closing browser..."),await o.close(),console.log(`[v0] ✓ Browser closed`)),"cloud"===this.mode){console.log("[v0] Stopping profile via GoLogin API...");let o=0,r=null;for(;o<3;)try{await this.gologinAPI.stopProfile(e),console.log(`[v0] ✓✓✓ Profile ${e} closed successfully ✓✓✓`);break}catch(e){o++,r=e,console.log(`[v0] Stop attempt ${o}/3 failed: ${e.message}`),o<3&&(console.log("[v0] Waiting 2 seconds before retry..."),await new Promise(e=>setTimeout(e,2e3)))}3===o&&(console.error(`[v0] ⚠️ Could not stop profile via API after 3 attempts`),console.error(`[v0] Last error: ${r?.message}`),console.log("[v0] Profile may need to be manually stopped in GoLogin dashboard"))}else console.log(`[v0] ✓ Profile closed`);return{success:!0}}catch(o){return console.error(`[v0] ❌ Failed to close profile ${e}`),console.error("[v0] Error:",o.message),{success:!1,error:o.message}}}}t()}catch(e){t(e)}})},83098:(e,o,r)=>{r.d(o,{U:()=>s,X:()=>t});class t{constructor(e){this.baseUrl="https://api.gologin.com",this.successfulEndpoint=null,this.apiKey=e}getEndpoint(){return this.successfulEndpoint}async getProfiles(){try{console.log("[v0] Fetching profiles using page-based pagination");let e=[],o=1,r=!0,t=null;for(;r;){let s=[`${this.baseUrl}/browser/v2?page=${o}`,`${this.baseUrl}/browser/v2?skip=${(o-1)*30}&limit=30`,`${this.baseUrl}/browser?page=${o}`],l=[],n=!1;for(let e of s)try{console.log(`[v0] Trying: ${e}`);let o=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok)continue;let r=await o.json();if(void 0!==r.allProfilesCount?t=r.allProfilesCount:void 0!==r.total&&(t=r.total),Array.isArray(r)?l=r:r.profiles&&Array.isArray(r.profiles)?l=r.profiles:r.data&&Array.isArray(r.data)&&(l=r.data),l.length>0){console.log(`[v0] ✓ Success with ${e} - got ${l.length} profiles`),n=!0;break}}catch(e){continue}if(!n||0===l.length){console.log(`[v0] No more profiles found at page ${o}`),r=!1;break}1===o&&null!==t&&console.log(`[v0] Total profiles reported: ${t}`),1===o&&l.length>0&&console.log("[v0] Sample profile structure:",JSON.stringify(l[0],null,2));let i=new Set(e.map(e=>e.id)),a=l.filter(e=>!i.has(e.id));if(console.log(`[v0] Page ${o}: ${l.length} profiles, ${a.length} new (${l.length-a.length} duplicates)`),0===a.length){console.log(`[v0] All profiles on page ${o} are duplicates - stopping`),r=!1;break}e.push(...a),o++,null!==t&&e.length>=t&&(console.log(`[v0] Reached total count of ${t}`),r=!1),o>20&&(console.log("[v0] Reached page limit of 20"),r=!1)}return console.log(`[v0] ✓ Fetched ${e.length} unique profiles`),this.successfulEndpoint=`${this.baseUrl}/browser/v2`,e}catch(e){throw console.error("[v0] Failed to fetch profiles:",e.message),Error(`Failed to fetch profiles from GoLogin. ${e.message}. Please check your API key at https://app.gologin.com/personalArea/TokenApi`)}}async startProfile(e){console.log(`[v0] Starting profile ${e} in cloud mode...`);let o=await fetch(`${this.baseUrl}/browser/${e}/web`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text();throw Error(`Failed to start profile: ${e}`)}let r=await o.json();return console.log("[v0] Start profile response:",JSON.stringify(r,null,2)),r}async stopProfile(e){let o=null;for(let r of[`/browser/${e}/stop`,`/browser/v2/${e}/stop`,`/browser/${e}/web/stop`])try{console.log(`[v0] Trying to stop profile at: ${r}`);let e=await fetch(`${this.baseUrl}${r}`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(e.ok)return console.log(`[v0] ✓ Profile stopped successfully using endpoint: ${r}`),e.json();if(404===e.status){console.log(`[v0] Profile might already be stopped (404 at ${r})`),o={status:404,message:"Profile not found or already stopped"};continue}let t=await e.text();o={status:e.status,message:t}}catch(e){console.log(`[v0] Error trying endpoint ${r}:`,e.message),o=e}if(o?.status===404)return console.log("[v0] Profile appears to be already stopped, continuing..."),{success:!0,message:"Profile already stopped"};throw Error(`Failed to stop profile after trying all endpoints: ${JSON.stringify(o)}`)}async getProfileStatus(e){try{let o=await fetch(`${this.baseUrl}/browser/${e}`,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text(),r=e;try{r=JSON.parse(e).message||e}catch{}throw Error(`${o.status}: ${r}`)}return o.json()}catch(e){if(e.message)throw e;throw Error(`Failed to get profile status: ${e}`)}}async getFolders(){try{let e=`${this.baseUrl}/folders`;console.log(`[v0] Fetching folders from ${e}`);let o=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text();throw Error(`GoLogin API error (${o.status}): ${e}`)}let r=await o.json(),t=Array.isArray(r)?r:r.folders||[];return console.log(`[v0] ✓ Fetched ${t.length} folders from GoLogin`),t}catch(e){return console.error("[v0] Failed to fetch folders:",e.message),[]}}}let s=new t(process.env.GOLOGIN_API_KEY||"")},19692:(e,o,r)=>{r.d(o,{t:()=>l});var t=r(67721),s=r(71615);async function l(){let e=await (0,s.cookies)();return(0,t.createServerClient)("https://umhdnhckxgqywxgpybgo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtaGRuaGNreGdxeXd4Z3B5YmdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDA1NzYsImV4cCI6MjA3NDk3NjU3Nn0.sodO3ZUaTWDxBBZitsrc_j3SUmVWBNlAsQoDAdzs8mI",{cookies:{getAll:()=>e.getAll(),setAll(o){try{o.forEach(({name:o,value:r,options:t})=>e.set(o,r,t))}catch{}}}})}}};var o=require("../../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[8948,4526,9702,5972],()=>r(4761));module.exports=t})();
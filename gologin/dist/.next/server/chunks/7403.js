"use strict";exports.id=7403,exports.ids=[7403],exports.modules={69083:(e,o,t)=>{t.d(o,{U:()=>r});class a{constructor(e){this.pattern=e}randomDelay(e,o){let t=e??this.pattern.action_delay.min;return Math.floor(Math.random()*((o??this.pattern.action_delay.max)-t+1))+t}async typeWithHumanSpeed(e,o){for(let t of e){await o.type(t);let e=this.randomDelay(this.pattern.typing_speed.min,this.pattern.typing_speed.max);await this.sleep(e)}}async randomPause(){if(this.pattern.random_pauses.enabled&&Math.random()<this.pattern.random_pauses.probability){let e=this.randomDelay(this.pattern.random_pauses.duration.min,this.pattern.random_pauses.duration.max);console.log(`[v0] Random pause: ${e}ms`),await this.sleep(e)}}async moveMouseNaturally(e,o,t){if(!this.pattern.mouse_movement.enabled){await e.mouse.move(o,t);return}let a={x:0,y:0},r=Math.floor(10*Math.random())+20,l=(o-a.x)/r,i=(t-a.y)/r;for(let o=0;o<r;o++){let t=a.x+l*o,r=a.y+i*o;await e.mouse.move(t,r),await this.sleep(10*Math.random()+5)}await e.mouse.move(o,t)}async scrollNaturally(e,o){if(!this.pattern.scroll_behavior.enabled){await e.evaluate(e=>window.scrollBy(0,e),o);return}let t=Math.floor(Math.abs(o)/100),a=o/t;for(let o=0;o<t;o++)await e.evaluate(e=>window.scrollBy(0,e),a),await this.sleep(this.randomDelay(50,150)),Math.random()<this.pattern.scroll_behavior.pause_probability&&await this.sleep(this.randomDelay(500,1500))}sleep(e){return new Promise(o=>setTimeout(o,e))}async waitRandom(e,o=20){let t=o/100*e;await this.sleep(e+(Math.random()*t*2-t))}}class r{constructor(e,o){this.page=e,this.behavior=new a(o)}async ensureGmailLoaded(){console.log("[v0] Ensuring Gmail is loaded...");try{let e=this.page.url();console.log(`[v0] Current URL: ${e}`),e.includes("mail.google.com")?console.log("[v0] Already on Gmail, checking if logged in..."):(console.log("[v0] Not on Gmail, navigating to inbox..."),await this.page.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),await this.behavior.waitRandom(2e3)),console.log("[v0] Checking if logged into Gmail...");let o=await this.page.evaluate(()=>{let e=!!document.querySelector('[gh="cm"]'),o=!!document.querySelector('[aria-label*="Inbox"]')||!!document.querySelector('[title*="Inbox"]'),t=!!document.querySelector('input[type="email"]')||!!document.querySelector('input[type="password"]');return{hasComposeButton:e,hasInboxLabel:o,hasLoginForm:t,isLoggedIn:(e||o)&&!t}});if(console.log("[v0] Login status:",JSON.stringify(o,null,2)),!o.isLoggedIn)throw Error("Not logged into Gmail. Please ensure the GoLogin profile has Gmail credentials saved or login manually first.");return console.log("[v0] ✓ Gmail is loaded and user is logged in"),{success:!0}}catch(e){throw console.error("[v0] ❌ Failed to ensure Gmail is loaded"),console.error("[v0] Error:",e.message),e}}async login(e,o){console.log("[v0] Starting Gmail login with human behavior"),console.log(`[v0] Email: ${e}`);try{console.log("[v0] Navigating to Gmail login page..."),await this.page.goto("https://accounts.google.com/signin/v2/identifier?service=mail",{waitUntil:"networkidle2"}),console.log("[v0] ✓ Page loaded"),await this.behavior.waitRandom(2e3),console.log("[v0] Looking for email input...");let t=await this.page.waitForSelector('input[type="email"]',{timeout:1e4});if(!t)throw Error("Email input not found");console.log("[v0] ✓ Email input found"),await this.behavior.randomPause(),console.log("[v0] Typing email..."),await this.behavior.typeWithHumanSpeed(e,t),await this.behavior.waitRandom(1e3),console.log("[v0] Clicking next button...");let a=await this.page.$("#identifierNext button");if(a)await a.click(),console.log("[v0] ✓ Next button clicked");else throw Error("Next button not found");await this.behavior.waitRandom(3e3),console.log("[v0] Looking for password input...");let r=await this.page.waitForSelector('input[type="password"]',{timeout:1e4});if(!r)throw Error("Password input not found");console.log("[v0] ✓ Password input found"),await this.behavior.randomPause(),console.log("[v0] Typing password..."),await this.behavior.typeWithHumanSpeed(o,r),await this.behavior.waitRandom(1e3),console.log("[v0] Clicking password next button...");let l=await this.page.$("#passwordNext button");if(l)await l.click(),console.log("[v0] ✓ Password next button clicked");else throw Error("Password next button not found");return console.log("[v0] Waiting for Gmail to load..."),await this.page.waitForNavigation({waitUntil:"networkidle2",timeout:3e4}),await this.behavior.waitRandom(2e3),console.log("[v0] ✓✓✓ Gmail login successful ✓✓✓"),{success:!0}}catch(e){console.error("[v0] ❌ Gmail login failed"),console.error("[v0] Error type:",e.name),console.error("[v0] Error message:",e.message),console.error("[v0] Error stack:",e.stack);try{let e=await this.page.screenshot({encoding:"base64"});console.log("[v0] Screenshot captured (base64 length):",e.length)}catch(e){console.error("[v0] Could not capture screenshot:",e)}return{success:!1,error:e.message}}}async checkInbox(){console.log("[v0] Checking inbox with human behavior");try{console.log("[v0] Navigating to inbox..."),await this.page.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2"}),console.log("[v0] ✓ Inbox loaded"),await this.behavior.waitRandom(2e3),console.log("[v0] Scrolling to view emails..."),await this.behavior.scrollNaturally(this.page,300),await this.behavior.randomPause();let e=await this.page.evaluate(()=>{let e=document.querySelector('[aria-label*="Unread"]');if(e){let o=e.textContent?.match(/\d+/);return o?Number.parseInt(o[0]):0}return 0}),o=await this.page.evaluate(()=>Array.from(document.querySelectorAll("tr.zA")).slice(0,10).map(e=>{let o=e.querySelector(".yW span")?.textContent||"",t=e.querySelector(".y6 span")?.textContent||"",a=e.querySelector(".xW span")?.textContent||"",r=e.classList.contains("zE");return{sender:o,subject:t,time:a,isUnread:r}}));return console.log(`[v0] ✓ Found ${o.length} emails, ${e} unread`),{success:!0,unreadCount:e,emails:o}}catch(e){return console.error("[v0] ❌ Check inbox failed"),console.error("[v0] Error:",e.message),{success:!1,error:e.message}}}async readEmail(e){console.log(`[v0] Reading email at index ${e}`);try{console.log("[v0] Finding email rows...");let o=await this.page.$$("tr.zA");if(console.log(`[v0] Found ${o.length} email rows`),e>=o.length)throw Error(`Email index ${e} out of range (only ${o.length} emails found)`);console.log(`[v0] Clicking on email ${e}...`),await this.behavior.randomPause(),await o[e].click(),await this.behavior.waitRandom(2e3),console.log("[v0] Scrolling to read content..."),await this.behavior.scrollNaturally(this.page,200),await this.behavior.randomPause(),await this.behavior.scrollNaturally(this.page,200);let t=await this.page.evaluate(()=>{let e=document.querySelector("h2.hP")?.textContent||"",o=document.querySelector(".gD")?.textContent||"",t=document.querySelector(".a3s.aiL")?.textContent||"";return{subject:e,sender:o,body:t.substring(0,500)}});return console.log("[v0] ✓ Email read successfully:",t.subject),await this.behavior.waitRandom(1e3),await this.page.goBack(),await this.behavior.waitRandom(1500),{success:!0,content:t}}catch(e){return console.error("[v0] ❌ Read email failed"),console.error("[v0] Error:",e.message),{success:!1,error:e.message}}}async starEmail(e){console.log(`[v0] Starring email at index ${e}`);try{console.log("[v0] Navigating to Gmail inbox..."),await this.page.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),await this.behavior.waitRandom(3e3),console.log("[v0] Checking if logged into Gmail...");let o=await this.page.evaluate(()=>{let e=!!document.querySelector('[gh="cm"]'),o=!!document.querySelector('[aria-label*="Inbox"]')||!!document.querySelector('[title*="Inbox"]'),t=!!document.querySelector('img[alt*="Gmail"]'),a=!!document.querySelector('input[type="email"]')||!!document.querySelector('input[type="password"]');return{hasComposeButton:e,hasInboxLabel:o,hasGmailLogo:t,hasLoginForm:a,isLoggedIn:(e||o)&&!a,url:window.location.href,title:document.title}});if(console.log("[v0] Login status:",JSON.stringify(o,null,2)),!o.isLoggedIn){console.log("[v0] ❌ Not logged into Gmail!");let e=await this.page.screenshot({encoding:"base64"});throw console.log("[v0] Screenshot captured for debugging (base64 length):",e.length),Error("Not logged into Gmail. Please ensure the GoLogin profile has Gmail credentials saved or login manually first.")}console.log("[v0] ✓ Logged into Gmail"),console.log("[v0] Waiting for Gmail interface to fully load..."),await this.page.waitForSelector('[role="main"]',{timeout:15e3}).catch(()=>{console.log("[v0] Main Gmail container not found")}),await this.behavior.waitRandom(2e3),console.log("[v0] Waiting for email rows to load...");let t=[],a=0;for(;0===t.length&&a<8;){for(let e of["tr.zA","tr[role='row']","div[role='row']"])if((t=await this.page.$$(e)).length>0){console.log(`[v0] Found ${t.length} email rows using selector: ${e}`);break}if(console.log(`[v0] Attempt ${a+1}: Found ${t.length} email rows`),0===t.length&&++a<8&&(console.log("[v0] No emails found, scrolling and waiting..."),await this.behavior.scrollNaturally(this.page,300),await this.behavior.waitRandom(2e3),3===a)){console.log("[v0] Trying to click inbox link to refresh...");let e=await this.page.$('a[href*="#inbox"]');e&&(await e.click(),await this.behavior.waitRandom(3e3))}}if(0===t.length){console.log("[v0] Capturing page state for debugging...");let e=await this.page.evaluate(()=>({url:window.location.href,title:document.title,hasMainRole:!!document.querySelector('[role="main"]'),hasTable:!!document.querySelector("table"),hasTr:document.querySelectorAll("tr").length,hasZaClass:document.querySelectorAll(".zA").length,bodyText:document.body.innerText.substring(0,500)}));console.log("[v0] Page state:",JSON.stringify(e,null,2));let o=await this.page.screenshot({encoding:"base64"});throw console.log("[v0] Screenshot captured for debugging (base64 length):",o.length),Error("Could not find email rows on page - Gmail may not have loaded properly or inbox is empty")}if(console.log(`[v0] Found ${t.length} email rows`),e>=t.length)throw Error(`Email index ${e} out of range (only ${t.length} emails found)`);console.log(`[v0] Checking if email ${e} is already starred...`);let r=await this.page.evaluate(e=>{let o=Array.from(document.querySelectorAll("tr.zA"))[e];if(!o)return{found:!1,isStarred:!1};for(let e of['span[role="checkbox"][aria-label*="Starred"]','span[role="checkbox"][aria-label*="Not starred"]','span[role="checkbox"][aria-label*="Star"]',"span.T-KT"]){let t=o.querySelector(e);if(t){let e=t.getAttribute("aria-label")||"",o=e.includes("Starred")&&!e.includes("Not starred");return{found:!0,isStarred:o,ariaLabel:e}}}return{found:!1,isStarred:!1}},e);if(console.log("[v0] Star status:",JSON.stringify(r,null,2)),r.isStarred)return console.log(`[v0] ⚠️ Email ${e} is already starred, skipping...`),{success:!0,alreadyStarred:!0};console.log(`[v0] Finding and clicking star button for email ${e}...`),await this.behavior.waitRandom(1e3);let l=t[e],i=null,n="";for(let e of['span[role="checkbox"][aria-label*="Not starred"]','span[role="checkbox"][aria-label*="Star"]','span[data-tooltip*="Star"]',"span.T-KT",'div[data-tooltip*="Star"]'])if(i=await l.$(e)){n=e,console.log(`[v0] ✓ Star button found using selector: ${e}`);break}if(!i){let e=await l.evaluate(e=>{let o=e.querySelectorAll("span[role='checkbox']");return Array.from(o).map(e=>({role:e.getAttribute("role"),ariaLabel:e.getAttribute("aria-label"),className:e.className}))});console.log("[v0] Could not find star button. Found elements:",JSON.stringify(e,null,2));let o=await this.page.screenshot({encoding:"base64"});throw console.log("[v0] Screenshot captured for debugging (base64 length):",o.length),Error("Star button not found with any selector")}console.log("[v0] Clicking star button..."),await i.click(),console.log(`[v0] ✓ Star button clicked using selector: ${n}`),await this.behavior.waitRandom(1e3);let s=await this.page.browser()?.pages();if(s&&s.length>1){console.log(`[v0] Detected ${s.length} open tabs, closing extra tabs...`);for(let e=1;e<s.length;e++)try{await s[e].close(),console.log(`[v0] ✓ Closed extra tab ${e}`)}catch(o){console.log(`[v0] Could not close tab ${e}`)}}return console.log("[v0] ✓✓✓ Email starred successfully ✓✓✓"),{success:!0,alreadyStarred:!1}}catch(e){console.error("[v0] ❌ Star email failed"),console.error("[v0] Error type:",e.name),console.error("[v0] Error message:",e.message),console.error("[v0] Error stack:",e.stack);try{let e=await this.page.screenshot({encoding:"base64"});console.log("[v0] Screenshot captured for debugging (base64 length):",e.length)}catch(e){console.error("[v0] Could not capture screenshot:",e)}return{success:!1,error:e.message}}}async sendEmail(e,o,t){console.log(`[v0] Sending email to ${e}`);try{console.log("[v0] Looking for compose button...");let a=await this.page.waitForSelector('[role="button"][gh="cm"]',{timeout:1e4});if(!a)throw Error("Compose button not found");console.log("[v0] ✓ Compose button found"),await this.behavior.randomPause(),await a.click(),await this.behavior.waitRandom(2e3),console.log("[v0] Filling in recipient...");let r=await this.page.waitForSelector('input[aria-label*="To"]',{timeout:1e4});if(!r)throw Error("To input not found");await this.behavior.typeWithHumanSpeed(e,r),await this.behavior.waitRandom(1e3),console.log("[v0] ✓ Recipient filled"),console.log("[v0] Filling in subject...");let l=await this.page.waitForSelector('input[name="subjectbox"]',{timeout:1e4});if(!l)throw Error("Subject input not found");await l.click(),await this.behavior.waitRandom(500),await this.behavior.typeWithHumanSpeed(o,l),await this.behavior.waitRandom(1e3),console.log("[v0] ✓ Subject filled"),console.log("[v0] Filling in body...");let i=await this.page.waitForSelector('[role="textbox"][aria-label*="Message"]',{timeout:1e4});if(!i)throw Error("Body input not found");await i.click(),await this.behavior.waitRandom(500),await this.behavior.typeWithHumanSpeed(t,i),await this.behavior.waitRandom(2e3),console.log("[v0] ✓ Body filled"),await this.behavior.randomPause(),console.log("[v0] Clicking send button...");let n=await this.page.waitForSelector('[role="button"][aria-label*="Send"]',{timeout:1e4});if(!n)throw Error("Send button not found");return await n.click(),await this.behavior.waitRandom(2e3),console.log("[v0] ✓✓✓ Email sent successfully ✓✓✓"),{success:!0}}catch(e){return console.error("[v0] ❌ Send email failed"),console.error("[v0] Error:",e.message),{success:!1,error:e.message}}}async searchEmails(e){console.log(`[v0] Searching for emails with query: ${e}`);try{console.log("[v0] Navigating to inbox first..."),await this.page.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),await this.behavior.waitRandom(2e3),console.log("[v0] Looking for search box...");let o=await this.page.waitForSelector('input[aria-label="Search mail"]',{timeout:1e4});if(!o)throw Error("Search box not found");console.log("[v0] ✓ Search box found"),await this.behavior.randomPause(),await o.click(),await this.behavior.waitRandom(500),await this.page.keyboard.down("Control"),await this.page.keyboard.press("A"),await this.page.keyboard.up("Control"),await this.page.keyboard.press("Backspace"),await this.behavior.waitRandom(300),console.log(`[v0] Typing search query: ${e}`),await this.behavior.typeWithHumanSpeed(e,o),await this.behavior.waitRandom(1e3),console.log("[v0] Looking for search button...");let t=await this.page.waitForSelector('button[aria-label="Search Mail"]',{timeout:5e3}).catch(()=>null);t?(console.log("[v0] Clicking search button..."),await t.click()):(console.log("[v0] Search button not found, pressing Enter..."),await this.page.keyboard.press("Enter")),console.log("[v0] Waiting for search results to load..."),await this.page.waitForFunction(()=>window.location.href.includes("#search/"),{timeout:1e4});let a=this.page.url();console.log(`[v0] Current URL after search: ${a}`),console.log("[v0] Waiting for Gmail to filter search results..."),await this.behavior.waitRandom(3e3);let r=0,l=0;for(let e=0;e<5;e++){let o=await this.page.evaluate(()=>document.querySelectorAll("tr.zA").length);if(console.log(`[v0] Check ${e+1}: Found ${o} email rows`),o===r&&o>0){if(++l>=2){console.log("[v0] ✓ Search results have stabilized");break}}else l=0;r=o,await this.behavior.waitRandom(1500)}let i=await this.page.$$("tr.zA");if(console.log(`[v0] Found ${i.length} emails matching search query`),i.length>0){let e=await this.page.evaluate(()=>Array.from(document.querySelectorAll("tr.zA")).slice(0,5).map((e,o)=>{let t=e.querySelector(".yW span")?.textContent||"",a=e.querySelector(".y6 span")?.textContent||"";return{index:o,sender:t,subject:a}}));console.log("[v0] First few emails in search results:",JSON.stringify(e,null,2))}if(0===i.length)return{success:!1,error:"No emails found matching search query",count:0};return{success:!0,count:i.length}}catch(e){console.error("[v0] ❌ Search emails failed"),console.error("[v0] Error:",e.message);try{let e=await this.page.screenshot({encoding:"base64"});console.log("[v0] Screenshot captured for debugging (base64 length):",e.length)}catch(e){console.error("[v0] Could not capture screenshot:",e)}return{success:!1,error:e.message}}}async replyToEmail(e,o,t){console.log(`[v0] Replying to email at index ${e}`),t&&console.log(`[v0] Expected sender: ${t}`);try{let a=this.page.url();console.log(`[v0] Current URL: ${a}`),console.log("[v0] Finding email rows...");let r=await this.page.$$("tr.zA");if(console.log(`[v0] Found ${r.length} email rows`),e>=r.length)throw Error(`Email index ${e} out of range (only ${r.length} emails found)`);let l=await this.page.evaluate(e=>{let o=Array.from(document.querySelectorAll("tr.zA"))[e];if(!o)return{found:!1};let t=o.querySelector(".yW span"),a=t?.textContent||"",r=t?.getAttribute("email")||t?.getAttribute("title")||t?.parentElement?.getAttribute("email")||t?.parentElement?.getAttribute("title")||"",l=o.querySelector(".y6 span")?.textContent||"";return{found:!0,senderName:a,senderEmail:r,subject:l,index:e}},e);if(console.log(`[v0] Email details at index ${e}:`,JSON.stringify(l,null,2)),t&&l.found){if(!l.senderName&&!l.senderEmail)return console.log(`[v0] ⚠️ Could not extract sender information from email`),{success:!1,error:"Could not extract sender information",senderMismatch:!0};let e=t.toLowerCase(),o=l.senderName?.toLowerCase().includes(e),a=l.senderEmail?.toLowerCase().includes(e);if(!(o||a))return console.log(`[v0] ⚠️ Sender mismatch! Expected: ${t}, Found name: ${l.senderName}, Found email: ${l.senderEmail}`),{success:!1,error:`Sender mismatch: expected ${t}, found ${l.senderName} (${l.senderEmail})`,senderMismatch:!0};console.log(`[v0] ✓ Sender matches: ${l.senderName} (${l.senderEmail})`)}console.log(`[v0] Opening email ${e}...`),await this.behavior.randomPause();let i=await this.page.evaluate(e=>{let o=Array.from(document.querySelectorAll("tr.zA"))[e];return o?(o.click(),{success:!0}):{success:!1,error:"Row not found in DOM"}},e);if(!i.success)throw Error(i.error||"Failed to click email row");await this.behavior.waitRandom(3e3),console.log("[v0] Waiting for email to load..."),await this.page.waitForSelector("h2.hP",{timeout:1e4}).catch(()=>{console.log("[v0] Email subject not found")}),await this.behavior.waitRandom(1e3);let n=await this.page.evaluate(()=>{let e=document.querySelector("h2.hP")?.textContent||"",o=document.querySelector(".gD"),t=o?.textContent||"",a=o?.getAttribute("email")||o?.getAttribute("data-hovercard-id")||document.querySelector("[email]")?.getAttribute("email")||"";return{subject:e,senderName:t,senderEmail:a}});console.log("[v0] Opened email details:",JSON.stringify(n,null,2)),console.log("[v0] Looking for reply button...");let s=await this.page.waitForSelector('[role="button"][aria-label*="Reply"]',{timeout:1e4});if(!s)throw Error("Reply button not found");console.log("[v0] ✓ Reply button found"),await this.behavior.randomPause(),await s.click(),await this.behavior.waitRandom(2e3),console.log("[v0] Waiting for reply compose box...");let c=await this.page.waitForSelector('[role="textbox"][aria-label*="Message"]',{timeout:1e4});if(!c)throw Error("Reply compose box not found");console.log("[v0] ✓ Reply compose box found"),console.log("[v0] Typing reply message..."),await c.click(),await this.behavior.waitRandom(500),await this.behavior.typeWithHumanSpeed(o,c),await this.behavior.waitRandom(2e3),console.log("[v0] ✓ Reply message typed"),await this.behavior.randomPause(),console.log("[v0] Clicking send button...");let u=await this.page.waitForSelector('[role="button"][aria-label*="Send"]',{timeout:1e4});if(!u)throw Error("Send button not found");return await u.click(),await this.behavior.waitRandom(2e3),console.log("[v0] ✓✓✓ Reply sent successfully ✓✓✓"),await this.behavior.waitRandom(1e3),console.log("[v0] Returning to search results..."),await this.page.goBack(),await this.behavior.waitRandom(2e3),await this.page.waitForSelector("table.F",{timeout:1e4}).catch(()=>{console.log("[v0] Search results table not found after going back")}),await this.behavior.waitRandom(1e3),{success:!0}}catch(e){return console.error("[v0] ❌ Reply to email failed"),console.error("[v0] Error:",e.message),{success:!1,error:e.message}}}async reportToInbox(e){let o=`in:spam ${e}`;console.log(`[v0] Reporting email to inbox with search query: ${o}`);try{console.log("[v0] Navigating to spam folder..."),await this.page.goto("https://mail.google.com/mail/u/0/#spam",{waitUntil:"networkidle2",timeout:3e4}),await this.behavior.waitRandom(2e3),console.log("[v0] Waiting for Gmail interface to fully load..."),await this.page.waitForSelector('[role="main"]',{timeout:15e3}).catch(()=>{console.log("[v0] Main Gmail container not found")}),await this.behavior.waitRandom(3e3),console.log("[v0] Looking for search box...");let e=null,t=0;for(;!e&&t<5;){for(let o of['input[aria-label*="Search"]','input[aria-label*="earch"]','input[placeholder*="earch"]','input[type="text"][aria-label*="mail"]','input[type="text"][aria-label*="message"]','input[type="text"][name="q"]','form[role="search"] input[type="text"]'])if(e=await this.page.$(o).catch(()=>null)){console.log(`[v0] ✓ Search box found using selector: ${o}`);break}!e&&(console.log(`[v0] Search box not found, attempt ${t+1}/5`),++t<5&&await this.behavior.waitRandom(2e3))}if(!e){let e=await this.page.evaluate(()=>({url:window.location.href,title:document.title,hasMainRole:!!document.querySelector('[role="main"]'),searchInputs:Array.from(document.querySelectorAll("input")).map(e=>({type:e.type,ariaLabel:e.getAttribute("aria-label"),placeholder:e.placeholder}))}));throw console.log("[v0] Page state:",JSON.stringify(e,null,2)),Error("Search box not found after multiple attempts")}console.log("[v0] ✓ Search box found"),await this.behavior.randomPause(),await e.click(),await this.behavior.waitRandom(500),await this.page.keyboard.down("Control"),await this.page.keyboard.press("A"),await this.page.keyboard.up("Control"),await this.page.keyboard.press("Backspace"),await this.behavior.waitRandom(300),console.log(`[v0] Typing search query: ${o}`),await this.behavior.typeWithHumanSpeed(o,e),await this.behavior.waitRandom(1e3),console.log("[v0] Looking for search button...");let a=null;for(let e of['button[aria-label*="Search"]','button[aria-label*="earch"]','button[type="submit"]'])if(a=await this.page.$(e).catch(()=>null)){console.log(`[v0] Search button found using selector: ${e}`);break}a?(console.log("[v0] Clicking search button..."),await a.click()):(console.log("[v0] Search button not found, pressing Enter..."),await this.page.keyboard.press("Enter")),console.log("[v0] Waiting for search results to load..."),await this.page.waitForFunction(()=>window.location.href.includes("#search/"),{timeout:1e4});let r=this.page.url();console.log(`[v0] Current URL after search: ${r}`),console.log("[v0] Waiting for Gmail to filter search results..."),await this.behavior.waitRandom(3e3);let l=0,i=0;for(let e=0;e<5;e++){let o=await this.page.evaluate(()=>document.querySelectorAll("tr.zA").length);if(console.log(`[v0] Check ${e+1}: Found ${o} email rows`),o===l&&o>0){if(++i>=2){console.log("[v0] ✓ Search results have stabilized");break}}else i=0;l=o,await this.behavior.waitRandom(1500)}let n=await this.page.$$("tr.zA");if(console.log(`[v0] Found ${n.length} emails in spam matching search query`),0===n.length)return{success:!1,error:"No emails found in spam matching search query",count:0};let s=await this.page.evaluate(()=>{let e=Array.from(document.querySelectorAll("tr.zA"))[0];if(!e)return null;let o=e.querySelector(".yW span")?.textContent||"",t=e.querySelector(".y6 span")?.textContent||"";return{sender:o,subject:t}});console.log("[v0] First email in spam:",JSON.stringify(s,null,2)),console.log("[v0] Opening the first email..."),await this.behavior.randomPause();let c=await this.page.evaluate(()=>{let e=Array.from(document.querySelectorAll("tr.zA"))[0];return e?(e.click(),{success:!0}):{success:!1,error:"Row not found in DOM"}});if(!c.success)throw Error(c.error||"Failed to open email");console.log("[v0] ✓ Email opened"),await this.behavior.waitRandom(3e3),console.log("[v0] Waiting for email to fully load..."),await this.page.waitForSelector("h2.hP",{timeout:1e4}).catch(()=>{console.log("[v0] Email subject not found")}),await this.behavior.waitRandom(2e3),console.log("[v0] Looking for 'Not spam' button in opened email...");let u=await this.page.evaluate(()=>{for(let e of['[aria-label*="Not spam"]','[aria-label*="not spam"]','[aria-label*="Non spam"]','[aria-label*="non spam"]','[aria-label*="l\xe9gitime"]','[aria-label*="Legitime"]','[aria-label*="No es spam"]','[aria-label*="Kein Spam"]','[data-tooltip*="Not spam"]','[data-tooltip*="spam"]','div[role="button"][aria-label*="spam"]','.nH.if div[role="button"][aria-label*="spam"]']){let o=document.querySelector(e);if(o)return o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{},500),o.click(),{success:!0,selector:e,ariaLabel:o.getAttribute("aria-label")||"N/A",dataTooltip:o.getAttribute("data-tooltip")||"N/A"}}let e=Array.from(document.querySelectorAll('div[role="button"]')).slice(0,20).map(e=>({ariaLabel:e.getAttribute("aria-label"),dataTooltip:e.getAttribute("data-tooltip"),textContent:e.textContent?.substring(0,50)}));return{success:!1,error:"'Not spam' button not found with any selector",foundButtons:e}});if(console.log("[v0] 'Not spam' button click result:",JSON.stringify(u,null,2)),!u.success){let e=await this.page.screenshot({encoding:"base64"});throw console.log("[v0] Screenshot captured for debugging (base64 length):",e.length),Error(u.error||"Failed to click 'Not spam' button")}console.log(`[v0] ✓ 'Not spam' button clicked using selector: ${u.selector}`),console.log("[v0] Waiting for Gmail to process the action and move email to inbox..."),await this.behavior.waitRandom(4e3);let g=await Promise.race([this.page.waitForFunction(e=>{let o=window.location.href;return o!==e&&!o.includes("/mail/u/0/#")},{timeout:1e4},this.page.url()).then(()=>({method:"url_change",success:!0})).catch(()=>null),this.page.waitForFunction(()=>{let e=window.location.href;return e.includes("#spam")||e.includes("#inbox")||e.includes("#search")},{timeout:1e4}).then(()=>({method:"redirected",success:!0})).catch(()=>null),new Promise(e=>setTimeout(()=>e({method:"timeout",success:!0}),1e4))]);console.log("[v0] Verification result:",JSON.stringify(g,null,2)),console.log("[v0] Giving Gmail extra time to complete the operation..."),await this.behavior.waitRandom(3e3);let d=this.page.url();return console.log(`[v0] Final URL: ${d}`),console.log("[v0] ✓✓✓ Email reported to inbox successfully ✓✓✓"),{success:!0,emailDetails:s}}catch(e){console.error("[v0] ❌ Report to inbox failed"),console.error("[v0] Error:",e.message);try{let e=await this.page.screenshot({encoding:"base64"});console.log("[v0] Screenshot captured for debugging (base64 length):",e.length)}catch(e){console.error("[v0] Could not capture screenshot:",e)}return{success:!1,error:e.message}}}}},53541:(e,o,t)=>{t.a(e,async(e,a)=>{try{t.d(o,{r:()=>n});var r=t(77250),l=t(83098),i=e([r]);r=(i.then?(await i)():i)[0];class n{constructor(e,o="cloud"){this.gologinInstance=null,this.gologinAPI=new l.X(e),this.apiKey=e,this.mode=o}async validateProfile(e){try{return console.log(`[v0] Validating profile ${e} with GoLogin API...`),await this.gologinAPI.getProfileStatus(e),console.log(`[v0] ✓ Profile validation successful`),{valid:!0}}catch(e){if(console.error(`[v0] ❌ Profile validation failed:`,e.message),e.message.includes("404")||e.message.includes("not found")||e.message.includes("deleted"))return{valid:!1,error:"Profile has been deleted from GoLogin",errorType:"PROFILE_DELETED"};if(e.message.includes("401")||e.message.includes("unauthorized"))return{valid:!1,error:"GoLogin API authentication failed",errorType:"AUTH_ERROR"};return{valid:!1,error:`Profile validation failed: ${e.message}`,errorType:"VALIDATION_ERROR"}}}async launchProfile(e){console.log("[v0] ========================================"),console.log(`[v0] Launching GoLogin profile: ${e}`),console.log(`[v0] Mode: ${this.mode.toUpperCase()}`),console.log("[v0] ========================================");try{let o;if("local"===this.mode){console.log("[v0] Step 1: Starting profile locally using GoLogin SDK...");try{let{GologinApi:a}=await Promise.resolve().then(t.t.bind(t,85129,23));this.gologinInstance=a({token:this.apiKey}),console.log("[v0] Launching local profile...");let{browser:r}=await this.gologinInstance.launch({profileId:e});o=r.wsEndpoint(),console.log(`[v0] ✓ Local profile launched`),console.log("[v0] Using LOCAL mode - connecting to local Orbita browser")}catch(e){if(console.error(`[v0] ❌ Failed to load GoLogin SDK for local mode`),console.error(`[v0] Error: ${e.message}`),e.message&&(e.message.includes("404")||e.message.includes("not found")||e.message.includes("deleted")))throw Error("PROFILE_DELETED: Profile has been deleted from GoLogin");throw console.error("[v0] Local mode requires running in a Node.js environment with GoLogin Desktop app installed"),Error("Local mode is not available in this environment. Please use Cloud mode or run the application locally with Node.js.")}}else console.log("[v0] Step 1: Starting profile via GoLogin API..."),await this.gologinAPI.startProfile(e),o=`wss://cloudbrowser.gologin.com/connect?token=${this.apiKey}&profile=${e}`,console.log("[v0] Using CLOUD mode - connecting to GoLogin cloud browser");console.log("[v0] Step 2: Connecting to WebSocket..."),console.log(`[v0] WebSocket URL: ${o.replace(this.apiKey,"***API_KEY***")}`);let a=await r.default.connect({browserWSEndpoint:o,defaultViewport:null,protocolTimeout:3e5});console.log(`[v0] ✓ Connected to browser`),console.log("[v0] Step 3: Getting browser page...");let l=await a.pages();console.log(`[v0] Found ${l.length} open pages`);let i=l[0]||await a.newPage();return console.log("[v0] ========================================"),console.log(`[v0] ✓✓✓ Profile ${e} launched successfully in ${this.mode.toUpperCase()} mode ✓✓✓`),console.log("[v0] ========================================"),{browser:a,page:i,success:!0}}catch(t){console.error("[v0] ========================================"),console.error(`[v0] ❌ Failed to launch profile ${e}`),console.error(`[v0] Error type: ${t.name}`),console.error(`[v0] Error message: ${t.message}`),console.error("[v0] Error stack:",t.stack),console.error("[v0] ========================================");let o=t.message?.startsWith("PROFILE_DELETED:")?"PROFILE_DELETED":"LAUNCH_ERROR";return{browser:null,page:null,success:!1,error:t.message,errorType:o}}}async closeProfile(e,o){console.log(`[v0] Closing profile: ${e}`);try{if(o&&(console.log("[v0] Closing browser..."),await o.close(),console.log(`[v0] ✓ Browser closed`)),"cloud"===this.mode){console.log("[v0] Stopping profile via GoLogin API...");let o=0,t=null;for(;o<3;)try{await this.gologinAPI.stopProfile(e),console.log(`[v0] ✓✓✓ Profile ${e} closed successfully ✓✓✓`);break}catch(e){o++,t=e,console.log(`[v0] Stop attempt ${o}/3 failed: ${e.message}`),o<3&&(console.log("[v0] Waiting 2 seconds before retry..."),await new Promise(e=>setTimeout(e,2e3)))}3===o&&(console.error(`[v0] ⚠️ Could not stop profile via API after 3 attempts`),console.error(`[v0] Last error: ${t?.message}`),console.log("[v0] Profile may need to be manually stopped in GoLogin dashboard"))}else console.log(`[v0] ✓ Profile closed`);return{success:!0}}catch(o){return console.error(`[v0] ❌ Failed to close profile ${e}`),console.error("[v0] Error:",o.message),{success:!1,error:o.message}}}}a()}catch(e){a(e)}})},61978:(e,o,t)=>{t.a(e,async(e,a)=>{try{t.d(o,{Z:()=>p});var r=t(53541),l=t(69083),i=t(73554),n=t(79851),s=t(74933),c=t(24613),u=t(62263),g=t(19765),d=t(87481),h=t(85345),m=e([r]);r=(m.then?(await m)():m)[0];class p{constructor(e,o,t){this.launcher=new r.r(e,o),this.behaviorPattern=t}async executeTask(e,o){console.log("[v0] ========================================"),console.log("[v0] Starting task execution"),console.log(`[v0] Task ID: ${e.id}`),console.log(`[v0] Task Type: ${e.task_type}`),console.log(`[v0] Profile: ${o.profile_name} (${o.profile_id})`),e.config?.count&&console.log(`[v0] Action Count: ${e.config.count}`),console.log("[v0] ========================================");let t=Date.now(),a={success:!1},r=null;try{console.log("[v0] Step 1: Validating profile with GoLogin API...");let m=await this.launcher.validateProfile(o.profile_id);if(!m.valid)throw console.error(`[v0] ❌ Profile validation failed: ${m.error}`),Error(`${m.errorType}: ${m.error}`);console.log(`[v0] ✓ Profile validation successful`),console.log("[v0] Step 2: Launching profile...");let p=await this.launcher.launchProfile(o.profile_id);r=p.browser;let w=p.page;if(!p.success||!r||!w){let e=p.error||"Failed to launch profile";console.error(`[v0] ❌ Profile launch failed: ${e}`);let o=p.errorType||"LAUNCH_ERROR";throw Error(`${o}: ${e}`)}console.log(`[v0] ✓ Profile launched successfully`),console.log("[v0] Step 3: Initializing Gmail automator...");let v=new l.U(w,this.behaviorPattern);switch(console.log(`[v0] ✓ Gmail automator ready`),console.log(`[v0] Step 4: Executing task type: ${e.task_type}`),e.task_type){case"login":a=await (0,i.j)(v,w,e.config);break;case"check_inbox":a=await (0,n.O)(v,w);break;case"read_email":a=await (0,s.q)(v,w,e.config);break;case"star_email":a=await (0,c.U)(v,w,e.config);break;case"send_email":a=await (0,u.e)(v,w,e.config);break;case"reply_to_email":a=await (0,g.d)(v,w,e.config);break;case"report_to_inbox":a=await (0,d.c)(v,w,e.config);break;case"check_gmail_status":a=await (0,h.t)(v,e.config);break;default:throw Error(`Unknown task type: ${e.task_type}`)}console.log(`[v0] ✓ Task execution result:`,a);let f=Date.now()-t;return console.log("[v0] ========================================"),console.log(`[v0] ✓ Task completed successfully in ${f}ms`),console.log("[v0] ========================================"),{success:a.success,duration:f,result:a}}catch(a){let e=Date.now()-t;console.error("[v0] ========================================"),console.error(`[v0] ❌ Task execution failed after ${e}ms`),console.error(`[v0] Error type: ${a.name}`),console.error(`[v0] Error message: ${a.message}`),console.error("[v0] Error stack:",a.stack),console.error("[v0] ========================================");let o=a.message?.split(":")[0]||"UNKNOWN_ERROR";return{success:!1,duration:e,error:a.message,errorType:o}}finally{if(r){console.log("[v0] Step 5: Closing profile...");try{await this.launcher.closeProfile(o.profile_id,r),console.log(`[v0] ✓ Profile closed`)}catch(e){console.error(`[v0] ⚠️ Error during profile cleanup: ${e.message}`)}}}}}a()}catch(e){a(e)}})},85345:(e,o,t)=>{t.d(o,{t:()=>a});async function a(e,o){console.log("[v0] Starting Gmail account status check...");try{let o=e.page.browser();console.log("[v0] Opening new tab for Gmail check...");let t=await o.newPage();try{console.log("[v0] Navigating to Gmail..."),await t.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),await new Promise(e=>setTimeout(e,3e3)),console.log("[v0] Analyzing Gmail page state...");let e=await t.evaluate(()=>{let e=window.location.href,o=document.title,t=!!document.querySelector('[gh="cm"]'),a=!!document.querySelector('[aria-label*="Inbox"]')||!!document.querySelector('[title*="Inbox"]')||!!document.querySelector('[aria-label*="Bo\xeete de r\xe9ception"]'),r=!!document.querySelector('img[alt*="Gmail"]'),l=document.querySelectorAll("tr.zA").length>0,i=!!document.querySelector('input[type="email"]'),n=!!document.querySelector('input[type="password"]'),s="";for(let e of['[jsname="B34EJ"]',".dEOOab",'[role="alert"]',".error-msg"]){let o=document.querySelector(e);if(o&&o.textContent){s=o.textContent.trim();break}}let c=document.body.textContent?.includes("blocked")||document.body.textContent?.includes("suspended")||document.body.textContent?.includes("disabled")||document.body.textContent?.includes("bloqu\xe9")||document.body.textContent?.includes("suspendu")||!1,u=document.body.textContent?.includes("verify")||document.body.textContent?.includes("verification")||document.body.textContent?.includes("v\xe9rif")||document.body.textContent?.includes("unusual activity")||document.body.textContent?.includes("activit\xe9 inhabituelle")||!1,g=document.body.textContent?.includes("password")||document.body.textContent?.includes("mot de passe")||document.body.textContent?.includes("sign in")||document.body.textContent?.includes("connexion")||!1,d=!!document.querySelector("[data-challengetype]")||!!document.querySelector('[id*="challenge"]')||!!document.querySelector('[name="totpPin"]');return{url:e,title:o,hasComposeButton:t,hasInboxLabel:a,hasGmailLogo:r,hasEmailRows:l,hasLoginForm:i||n,hasEmailInput:i,hasPasswordInput:n,errorText:s,hasBlockedMessage:c,hasVerificationMessage:u,hasPasswordMessage:g,has2FAPrompt:d,bodyTextSample:document.body.textContent?.substring(0,500)||""}});console.log("[v0] Page state analysis:",JSON.stringify(e,null,2));let o="unknown",a="",r=(e.hasComposeButton||e.hasInboxLabel||e.hasEmailRows)&&!e.hasLoginForm;return r?(o="ok",a="Gmail account is working normally"):e.hasLoginForm||e.hasPasswordMessage&&!r?(o="password_required",a="Account requires login or password"):e.has2FAPrompt?(o="verification_required",a="Account requires verification or 2FA"):e.hasVerificationMessage&&!r?(o="verification_required",a="Account requires verification"):e.hasBlockedMessage&&!r?(o="blocked",a="Gmail account is blocked or suspended"):e.errorText?(o="error",a=`Error: ${e.errorText}`):(o="unknown",a="Unable to determine account status"),console.log(`[v0] ✓ Gmail status check complete: ${o}`),await t.close(),{success:!0,status:o,message:a,details:{hasInbox:e.hasInboxLabel||e.hasEmailRows,hasComposeButton:e.hasComposeButton,hasLoginForm:e.hasLoginForm,errorText:e.errorText||void 0,url:e.url}}}catch(e){try{await t.close()}catch(e){console.log("[v0] Could not close new tab:",e)}throw e}}catch(e){return console.error("[v0] ❌ Gmail status check failed"),console.error("[v0] Error:",e.message),{success:!1,status:"error",message:`Failed to check Gmail status: ${e.message}`}}}},79851:(e,o,t)=>{t.d(o,{O:()=>a});async function a(e,o){return console.log("[v0] Checking inbox..."),await e.checkInbox()}},73554:(e,o,t)=>{t.d(o,{j:()=>a});async function a(e,o,t={}){let a;-1===t.duration||t.waitForManualClose?(a=-1,console.log("[v0] Manual close mode enabled - profile will stay open until you close it manually")):t.minDuration&&t.maxDuration?(a=Math.floor(Math.random()*(t.maxDuration-t.minDuration+1))+t.minDuration,console.log(`[v0] Using random duration: ${a}s (range: ${t.minDuration}-${t.maxDuration}s)`)):a=t.duration||10,-1!==a&&console.log(`[v0] Opening Gmail and keeping profile open for ${a} seconds...`);try{console.log("[v0] Navigating to Gmail inbox..."),await o.goto("https://mail.google.com/mail/u/0/#inbox",{waitUntil:"networkidle2",timeout:3e4}),await new Promise(e=>setTimeout(e,3e3)),console.log("[v0] Checking if logged into Gmail...");let e=await o.evaluate(()=>{let e=!!document.querySelector('[gh="cm"]'),o=!!document.querySelector('[aria-label*="Inbox"]')||!!document.querySelector('[title*="Inbox"]');document.querySelector('img[alt*="Gmail"]');let t=!!document.querySelector('input[type="email"]')||!!document.querySelector('input[type="password"]');return(e||o)&&!t});if(e?console.log(`[v0] ✓ User is logged in to Gmail`):console.log(`[v0] ⚠️ User is not logged in to Gmail`),-1===a)return console.log("[v0] Profile is now open. Close the browser window manually to continue to the next profile."),new Promise(t=>{o.browser().on("disconnected",()=>{console.log(`[v0] ✓ Browser closed manually by user`),t({success:!0,message:"Profile closed manually by user",duration:-1,loggedIn:e,manualClose:!0})}),o.on("close",()=>{console.log(`[v0] ✓ Page closed`),t({success:!0,message:"Profile closed manually by user",duration:-1,loggedIn:e,manualClose:!0})})});return console.log(`[v0] Waiting for ${a} seconds before closing...`),await new Promise(e=>setTimeout(e,1e3*a)),console.log(`[v0] ✓ Duration completed`),{success:!0,message:`Profile kept open for ${a} seconds`,duration:a,loggedIn:e}}catch(e){return console.error("[v0] ❌ Login task failed"),console.error("[v0] Error:",e.message),{success:!1,error:e.message}}}},74933:(e,o,t)=>{t.d(o,{q:()=>a});async function a(e,o,t){let a=t?.count||1;console.log(`[v0] Reading ${a} email(s)...`),await e.ensureGmailLoaded();let r=[];for(let o=0;o<a;o++){console.log(`[v0] Reading email ${o+1}/${a} at index ${o}`);let t=await e.readEmail(o);if(r.push(t),!t.success){console.log(`[v0] Failed to read email ${o+1}, stopping...`);break}}return{success:r.every(e=>e.success),count:r.filter(e=>e.success).length,results:r}}},19765:(e,o,t)=>{t.d(o,{d:()=>a});async function a(e,o,t){if(!t?.searchFrom||!t?.replyMessage)throw Error("Reply configuration incomplete (missing searchFrom or replyMessage)");console.log(`[v0] Searching for emails from: ${t.searchFrom}`),await e.ensureGmailLoaded();let a=`from:${t.searchFrom}`,r=await e.searchEmails(a);if(!r.success||0===r.count)throw Error(`No emails found from ${t.searchFrom}`);console.log(`[v0] Found ${r.count} email(s) in search results`);let l=t?.count||t.action_count||1;console.log(`[v0] Replying to ${l} email(s)...`);let i=[];for(let o=0;o<Math.min(l,r.count||0);o++){console.log(`[v0] Replying to email ${o+1}/${l} at index ${o}`);let a=await e.replyToEmail(o,t.replyMessage);if(i.push(a),!a.success){console.log(`[v0] Failed to reply to email at index ${o}, stopping...`);break}console.log(`[v0] ✓ Successfully replied to email ${o+1}/${l}`)}let n=i.filter(e=>e.success).length;return{success:n>0,count:n,requested:l,results:i}}},87481:(e,o,t)=>{t.d(o,{c:()=>a});async function a(e,o,t){if(console.log("[v0] Handling report to inbox task"),!t.search_query)throw Error("search_query is required for report_to_inbox task");console.log(`[v0] Search query: ${t.search_query}`),await e.ensureGmailLoaded();let a=await e.reportToInbox(t.search_query);if(!a.success)throw Error(a.error||"Failed to report email to inbox");return{success:!0,emailDetails:a.emailDetails}}},62263:(e,o,t)=>{t.d(o,{e:()=>a});async function a(e,o,t){if(!t?.to||!t?.subject||!t?.body)throw Error("Email configuration incomplete (missing to, subject, or body)");return console.log(`[v0] Sending email to: ${t.to}`),await e.ensureGmailLoaded(),await e.sendEmail(t.to,t.subject,t.body)}},24613:(e,o,t)=>{t.d(o,{U:()=>a});async function a(e,o,t){let a=t?.count||1;console.log(`[v0] Starring ${a} email(s)...`),await e.ensureGmailLoaded();let r=[],l=0,i=0;for(;i<a&&l<50;){console.log(`[v0] Attempting to star email ${i+1}/${a} at index ${l}`);let o=await e.starEmail(l);if(!o.success){console.log(`[v0] Failed to star email at index ${l}, stopping...`),r.push(o);break}if(o.alreadyStarred){console.log(`[v0] Email at index ${l} was already starred, moving to next email...`),l++;continue}r.push(o),i++,l++,console.log(`[v0] ✓ Successfully starred ${i}/${a} emails`)}return i<a&&l>=50&&console.log(`[v0] ⚠️ Reached maximum attempts (50), only starred ${i}/${a} emails`),{success:i>0,count:i,requested:a,results:r}}},83098:(e,o,t)=>{t.d(o,{U:()=>r,X:()=>a});class a{constructor(e){this.baseUrl="https://api.gologin.com",this.successfulEndpoint=null,this.apiKey=e}getEndpoint(){return this.successfulEndpoint}async getProfiles(){try{console.log("[v0] Fetching profiles using page-based pagination");let e=[],o=1,t=!0,a=null;for(;t;){let r=[`${this.baseUrl}/browser/v2?page=${o}`,`${this.baseUrl}/browser/v2?skip=${(o-1)*30}&limit=30`,`${this.baseUrl}/browser?page=${o}`],l=[],i=!1;for(let e of r)try{console.log(`[v0] Trying: ${e}`);let o=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok)continue;let t=await o.json();if(void 0!==t.allProfilesCount?a=t.allProfilesCount:void 0!==t.total&&(a=t.total),Array.isArray(t)?l=t:t.profiles&&Array.isArray(t.profiles)?l=t.profiles:t.data&&Array.isArray(t.data)&&(l=t.data),l.length>0){console.log(`[v0] ✓ Success with ${e} - got ${l.length} profiles`),i=!0;break}}catch(e){continue}if(!i||0===l.length){console.log(`[v0] No more profiles found at page ${o}`),t=!1;break}1===o&&null!==a&&console.log(`[v0] Total profiles reported: ${a}`),1===o&&l.length>0&&console.log("[v0] Sample profile structure:",JSON.stringify(l[0],null,2));let n=new Set(e.map(e=>e.id)),s=l.filter(e=>!n.has(e.id));if(console.log(`[v0] Page ${o}: ${l.length} profiles, ${s.length} new (${l.length-s.length} duplicates)`),0===s.length){console.log(`[v0] All profiles on page ${o} are duplicates - stopping`),t=!1;break}e.push(...s),o++,null!==a&&e.length>=a&&(console.log(`[v0] Reached total count of ${a}`),t=!1),o>20&&(console.log("[v0] Reached page limit of 20"),t=!1)}return console.log(`[v0] ✓ Fetched ${e.length} unique profiles`),this.successfulEndpoint=`${this.baseUrl}/browser/v2`,e}catch(e){throw console.error("[v0] Failed to fetch profiles:",e.message),Error(`Failed to fetch profiles from GoLogin. ${e.message}. Please check your API key at https://app.gologin.com/personalArea/TokenApi`)}}async startProfile(e){console.log(`[v0] Starting profile ${e} in cloud mode...`);let o=await fetch(`${this.baseUrl}/browser/${e}/web`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text();throw Error(`Failed to start profile: ${e}`)}let t=await o.json();return console.log("[v0] Start profile response:",JSON.stringify(t,null,2)),t}async stopProfile(e){let o=null;for(let t of[`/browser/${e}/stop`,`/browser/v2/${e}/stop`,`/browser/${e}/web/stop`])try{console.log(`[v0] Trying to stop profile at: ${t}`);let e=await fetch(`${this.baseUrl}${t}`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(e.ok)return console.log(`[v0] ✓ Profile stopped successfully using endpoint: ${t}`),e.json();if(404===e.status){console.log(`[v0] Profile might already be stopped (404 at ${t})`),o={status:404,message:"Profile not found or already stopped"};continue}let a=await e.text();o={status:e.status,message:a}}catch(e){console.log(`[v0] Error trying endpoint ${t}:`,e.message),o=e}if(o?.status===404)return console.log("[v0] Profile appears to be already stopped, continuing..."),{success:!0,message:"Profile already stopped"};throw Error(`Failed to stop profile after trying all endpoints: ${JSON.stringify(o)}`)}async getProfileStatus(e){try{let o=await fetch(`${this.baseUrl}/browser/${e}`,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text(),t=e;try{t=JSON.parse(e).message||e}catch{}throw Error(`${o.status}: ${t}`)}return o.json()}catch(e){if(e.message)throw e;throw Error(`Failed to get profile status: ${e}`)}}async getFolders(){try{let e=`${this.baseUrl}/folders`;console.log(`[v0] Fetching folders from ${e}`);let o=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!o.ok){let e=await o.text();throw Error(`GoLogin API error (${o.status}): ${e}`)}let t=await o.json(),a=Array.isArray(t)?t:t.folders||[];return console.log(`[v0] ✓ Fetched ${a.length} folders from GoLogin`),a}catch(e){return console.error("[v0] Failed to fetch folders:",e.message),[]}}}let r=new a(process.env.GOLOGIN_API_KEY||"")},99064:(e,o,t)=>{t.d(o,{S:()=>l});var a=t(61657);let r=null;function l(){if(r)return r;if(!process.env.SUPABASE_SERVICE_ROLE_KEY)throw Error("SUPABASE_SERVICE_ROLE_KEY is not set");return r=(0,a.eI)("https://umhdnhckxgqywxgpybgo.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}},19692:(e,o,t)=>{t.d(o,{t:()=>l});var a=t(67721),r=t(71615);async function l(){let e=await (0,r.cookies)();return(0,a.createServerClient)("https://umhdnhckxgqywxgpybgo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtaGRuaGNreGdxeXd4Z3B5YmdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDA1NzYsImV4cCI6MjA3NDk3NjU3Nn0.sodO3ZUaTWDxBBZitsrc_j3SUmVWBNlAsQoDAdzs8mI",{cookies:{getAll:()=>e.getAll(),setAll(o){try{o.forEach(({name:o,value:t,options:a})=>e.set(o,t,a))}catch{}}}})}},97957:(e,o,t)=>{t.d(o,{B:()=>a});function a(e){return"1"===process.env.VERCEL||process.env.VERCEL_ENV?(console.log("[v0] Running on Vercel - forcing cloud mode"),"cloud"):(console.log(`[v0] Running locally - using user preference: ${e}`),e)}}};
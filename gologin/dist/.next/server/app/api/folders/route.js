"use strict";(()=>{var e={};e.id=408,e.ids=[408],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},14840:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>m,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var r={};o.r(r),o.d(r,{GET:()=>u});var s=o(49303),a=o(88716),i=o(60670),l=o(87070),n=o(19692),c=o(46569),p=o(83098);async function u(){try{if(await (0,c.GJ)()){let e=new p.X(process.env.GOLOGIN_API_KEY),t=(await e.getFolders()).map(e=>e.name).filter(Boolean).sort();return l.NextResponse.json({folders:t})}let e=await (0,n.t)(),{data:t,error:o}=await e.from("gologin_profiles").select("folder_name").not("folder_name","is",null);if(o)throw o;let r=Array.from(new Set(t.map(e=>e.folder_name).filter(Boolean)));return l.NextResponse.json({folders:r.sort()})}catch(e){return console.error("[v0] Error fetching folders:",e),l.NextResponse.json({error:e.message},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/folders/route",pathname:"/api/folders",filename:"route",bundlePath:"app/api/folders/route"},resolvedPagePath:"D:\\appProject\\GologinAutomation\\gologin\\app\\api\\folders\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:h}=d,m="/api/folders/route";function y(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},83098:(e,t,o)=>{o.d(t,{U:()=>s,X:()=>r});class r{constructor(e){this.baseUrl="https://api.gologin.com",this.successfulEndpoint=null,this.apiKey=e}getEndpoint(){return this.successfulEndpoint}async getProfiles(){try{console.log("[v0] Fetching profiles using page-based pagination");let e=[],t=1,o=!0,r=null;for(;o;){let s=[`${this.baseUrl}/browser/v2?page=${t}`,`${this.baseUrl}/browser/v2?skip=${(t-1)*30}&limit=30`,`${this.baseUrl}/browser?page=${t}`],a=[],i=!1;for(let e of s)try{console.log(`[v0] Trying: ${e}`);let t=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!t.ok)continue;let o=await t.json();if(void 0!==o.allProfilesCount?r=o.allProfilesCount:void 0!==o.total&&(r=o.total),Array.isArray(o)?a=o:o.profiles&&Array.isArray(o.profiles)?a=o.profiles:o.data&&Array.isArray(o.data)&&(a=o.data),a.length>0){console.log(`[v0] ✓ Success with ${e} - got ${a.length} profiles`),i=!0;break}}catch(e){continue}if(!i||0===a.length){console.log(`[v0] No more profiles found at page ${t}`),o=!1;break}1===t&&null!==r&&console.log(`[v0] Total profiles reported: ${r}`),1===t&&a.length>0&&console.log("[v0] Sample profile structure:",JSON.stringify(a[0],null,2));let l=new Set(e.map(e=>e.id)),n=a.filter(e=>!l.has(e.id));if(console.log(`[v0] Page ${t}: ${a.length} profiles, ${n.length} new (${a.length-n.length} duplicates)`),0===n.length){console.log(`[v0] All profiles on page ${t} are duplicates - stopping`),o=!1;break}e.push(...n),t++,null!==r&&e.length>=r&&(console.log(`[v0] Reached total count of ${r}`),o=!1),t>20&&(console.log("[v0] Reached page limit of 20"),o=!1)}return console.log(`[v0] ✓ Fetched ${e.length} unique profiles`),this.successfulEndpoint=`${this.baseUrl}/browser/v2`,e}catch(e){throw console.error("[v0] Failed to fetch profiles:",e.message),Error(`Failed to fetch profiles from GoLogin. ${e.message}. Please check your API key at https://app.gologin.com/personalArea/TokenApi`)}}async startProfile(e){console.log(`[v0] Starting profile ${e} in cloud mode...`);let t=await fetch(`${this.baseUrl}/browser/${e}/web`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(!t.ok){let e=await t.text();throw Error(`Failed to start profile: ${e}`)}let o=await t.json();return console.log("[v0] Start profile response:",JSON.stringify(o,null,2)),o}async stopProfile(e){let t=null;for(let o of[`/browser/${e}/stop`,`/browser/v2/${e}/stop`,`/browser/${e}/web/stop`])try{console.log(`[v0] Trying to stop profile at: ${o}`);let e=await fetch(`${this.baseUrl}${o}`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`}});if(e.ok)return console.log(`[v0] ✓ Profile stopped successfully using endpoint: ${o}`),e.json();if(404===e.status){console.log(`[v0] Profile might already be stopped (404 at ${o})`),t={status:404,message:"Profile not found or already stopped"};continue}let r=await e.text();t={status:e.status,message:r}}catch(e){console.log(`[v0] Error trying endpoint ${o}:`,e.message),t=e}if(t?.status===404)return console.log("[v0] Profile appears to be already stopped, continuing..."),{success:!0,message:"Profile already stopped"};throw Error(`Failed to stop profile after trying all endpoints: ${JSON.stringify(t)}`)}async getProfileStatus(e){try{let t=await fetch(`${this.baseUrl}/browser/${e}`,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!t.ok){let e=await t.text(),o=e;try{o=JSON.parse(e).message||e}catch{}throw Error(`${t.status}: ${o}`)}return t.json()}catch(e){if(e.message)throw e;throw Error(`Failed to get profile status: ${e}`)}}async getFolders(){try{let e=`${this.baseUrl}/folders`;console.log(`[v0] Fetching folders from ${e}`);let t=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!t.ok){let e=await t.text();throw Error(`GoLogin API error (${t.status}): ${e}`)}let o=await t.json(),r=Array.isArray(o)?o:o.folders||[];return console.log(`[v0] ✓ Fetched ${r.length} folders from GoLogin`),r}catch(e){return console.error("[v0] Failed to fetch folders:",e.message),[]}}}let s=new r(process.env.GOLOGIN_API_KEY||"")},19692:(e,t,o)=>{o.d(t,{t:()=>a});var r=o(67721),s=o(71615);async function a(){let e=await (0,s.cookies)();return(0,r.createServerClient)("https://umhdnhckxgqywxgpybgo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtaGRuaGNreGdxeXd4Z3B5YmdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDA1NzYsImV4cCI6MjA3NDk3NjU3Nn0.sodO3ZUaTWDxBBZitsrc_j3SUmVWBNlAsQoDAdzs8mI",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:o,options:r})=>e.set(t,o,r))}catch{}}}})}},46569:(e,t,o)=>{o.d(t,{GJ:()=>a,kF:()=>i});var r=o(19692);async function s(){let e=await (0,r.t)(),{data:{user:t}}=await e.auth.getUser();return t}async function a(){let e=await (0,r.t)(),t=await s();if(!t)return!1;console.log("[v0] Checking admin status for user:",t.email);let{data:o,error:a}=await e.from("users").select("role").eq("email",t.email).single();if(console.log("[v0] User data from database:",o),console.log("[v0] Query error:",a),a||!o)return console.log("[v0] No user data found or error occurred"),!1;let i="admin"===o.role;return console.log("[v0] Is admin:",i),i}async function i(){if(!await a())throw Error("Unauthorized: Admin access required")}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[8948,4526,9702,5972],()=>o(14840));module.exports=r})();